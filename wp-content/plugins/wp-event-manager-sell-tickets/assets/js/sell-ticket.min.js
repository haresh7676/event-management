var SellTicket=function(){return{init:function(){if(Common.logInfo("SellTicket.init..."),jQuery("#order_now").on("click",SellTicket.actions.addtoCart),jQuery(".event_ticket_add_link").on("click",SellTicket.actions.addLink),jQuery(document).delegate(".remove-row","click",SellTicket.actions.deleteTickets),void 0!==jQuery.fn.popover&&jQuery('[data-toggle="popover"]').popover(),jQuery(".repeated-row").length>0){var e=0;jQuery(".fieldset-paid_tickets").find(":input.repeated-row").each(function(){e=this.value,jQuery("#paid_tickets_ticket_sales_start_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#paid_tickets_ticket_sales_end_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(t,i){return{minDate:jQuery("#paid_tickets_ticket_sales_start_date_"+e).datepicker("getDate")}}})}),jQuery(".fieldset-free_tickets").find(":input.repeated-row").each(function(){e=this.value,jQuery("#free_tickets_ticket_sales_start_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#free_tickets_ticket_sales_end_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(t,i){return{minDate:jQuery("#free_tickets_ticket_sales_start_date_"+e).datepicker("getDate")}}})}),jQuery(".fieldset-donation_tickets").find(":input.repeated-row").each(function(){e=this.value,jQuery("#donation_tickets_ticket_sales_start_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#donation_tickets_ticket_sales_end_date_"+e).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(t,i){return{minDate:jQuery("#donation_tickets_ticket_sales_start_date_"+e).datepicker("getDate")}}})})}},actions:{addLink:function(e){Common.logInfo("SellTicket.addLink...");var t=jQuery(this).closest(".field"),i=0;t.find("input.repeated-row").each(function(){parseInt(jQuery(this).val())>i&&(i=parseInt(jQuery(this).val()))});var _=jQuery(this).data("row").replace(/%%repeated-row-index%%/g,i+1);jQuery(this).before(_),jQuery(".settings-details").hide();var a=i+1;jQuery("#paid_tickets_ticket_sales_start_date_"+a).length>0&&(jQuery("#paid_tickets_ticket_sales_start_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#paid_tickets_ticket_sales_end_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(e,t){return{minDate:jQuery("#paid_tickets_ticket_sales_start_date_"+a).datepicker("getDate")}}}),jQuery("#paid_tickets_ticket_sales_start_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step}),jQuery("#paid_tickets_ticket_sales_end_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step})),jQuery("#free_tickets_ticket_sales_start_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#free_tickets_ticket_sales_end_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(e,t){return{minDate:jQuery("#free_tickets_ticket_sales_start_date_"+a).datepicker("getDate")}}}),jQuery("#free_tickets_ticket_sales_start_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step}),jQuery("#free_tickets_ticket_sales_end_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step}),jQuery("#donation_tickets_ticket_sales_start_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format}),jQuery("#donation_tickets_ticket_sales_end_date_"+a).datepicker({minDate:0,dateFormat:event_manager_sell_tickets_sell_ticket.i18n_datepicker_format,beforeShow:function(e,t){return{minDate:jQuery("#donation_tickets_ticket_sales_start_date_"+a).datepicker("getDate")}}}),jQuery("#donation_tickets_ticket_sales_start_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step}),jQuery("#donation_tickets_ticket_sales_end_time_"+a).timepicker({timeFormat:event_manager_sell_tickets_sell_ticket.i18n_timepicker_format,step:event_manager_sell_tickets_sell_ticket.i18n_timepicker_step}),e.preventDefault()},deleteTickets:function(e){Common.logInfo("SellTicket.deleteTickets..."),confirm(event_manager_sell_tickets_sell_ticket.i18n_confirm_delete)&&jQuery("."+e.target.id).remove(),e.preventDefault()},addtoCart:function(e){Common.logInfo("SellTicket.addtoCart...");var t=new Array(""),_=new Array(""),a={},r=jQuery("#total_ticket").val();if(r<=0)return!1;for(i=0;i<r;i++)jQuery("#quantity-"+i).length<=0||0==jQuery("#quantity-"+i).val()||(t=jQuery("#quantity-"+i).val(),_=jQuery("#product-"+i).val(),donation_price=jQuery("#donation_price-"+i).val(),a[i]={product_id:_,quantity:t,price:donation_price});if(t<=0)return jQuery("#sell-ticket-status-message").html(event_manager_sell_tickets_sell_ticket.i18n_no_ticket_found),!1;jQuery.ajax({type:"POST",url:event_manager_sell_tickets_sell_ticket.ajaxUrl.toString().replace("%%endpoint%%","add_tickets_to_cart"),data:{tickets_to_add:a},beforeSend:function(e,t){Common.logInfo("Before send called..."),jQuery("#sell-ticket-status-message").addClass("alert-infomation"),jQuery("#sell-ticket-status-message").html(event_manager_sell_tickets_sell_ticket.i18n_loading_message)},success:function(e){jQuery("#sell-ticket-status-message").removeClass("alert-infomation"),jQuery("#sell-ticket-status-message").addClass("alert-success"),jQuery("#sell-ticket-status-message").html(event_manager_sell_tickets_sell_ticket.i18n_added_to_cart),window.location.href=event_manager_sell_tickets_sell_ticket.redirectUrl},error:function(e,t,i){jQuery("#sell-ticket-status-message").removeClass("success-green-message"),jQuery("#sell-ticket-status-message").addClass("error-red-message"),jQuery("#sell-ticket-status-message").html(event_manager_sell_tickets_sell_ticket.i18n_error_message)},complete:function(e,t){}}),e.preventDefault()}}}};SellTicket=SellTicket(),jQuery(document).ready(function(e){SellTicket.init()});